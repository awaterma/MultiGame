<?xml version="1.0" encoding="utf-8"?>
<mx:Box xmlns:mx="http://www.adobe.com/2006/mxml"
	xmlns:component="mx.ecosur.multigame.component.*" 
	width="100%" height="100%" horizontalAlign="center" verticalAlign="middle" creationComplete="init(event)">

	<mx:Metadata>
        [Event(name="registered", type="mx.ecosur.multigame.event.GameEvent")]
        [Event(name="gameChosen", type="mx.ecosur.multigame.event.GameEvent")]
        [Event(name="gameJoined", type="mx.ecosur.multigame.event.GameEvent")]
    </mx:Metadata>

	<mx:Script> 
        <![CDATA[

        	import mx.rpc.events.FaultEvent;
        	import mx.rpc.events.ResultEvent;
            import flash.utils.Timer;
            import mx.controls.Alert;
            import mx.ecosur.multigame.entity.Registrant;
            import mx.ecosur.multigame.event.*;
            
            [Bindable]
            public var player:Registrant;
            public var timer:Timer;
    
            private function init(event:Event):void {
            	introTxt.text = "Welcome " + player.name + ".\n\nYou may rejoin an unfinished game, join a pending game, or start a new game below.";
            }

            public function reload(event:Event):void {
            	gameList.reload(event);
            	pendingList.reload(event);
            }
            
            private function resultHandler(event:ResultEvent):void{
            	dispatchEvent(new Event("complete"));
            }   
                        
            private function faultHandler(event:FaultEvent):void{
            	Alert.show(event.fault.faultString, "Error");
            }
          
        ]]>
    </mx:Script>
    <mx:RemoteObject id="gameService" destination="gameService" result="resultHandler(event)" fault="faultHandler(event)" />
	<mx:Panel title="Multigame Platform" paddingLeft="5" paddingRight="5" paddingBottom="5">
		<mx:Text paddingLeft="10" paddingRight="10" paddingTop="10" id="introTxt"/>
		<mx:TabNavigator width="100%" height="250">
			<component:JoinUnfinishedGame label="Join Unfinished Game" id="gameList" player="{player}" height="100%" width="100%" gameChosen="dispatchEvent(event)"/>
            <component:JoinPendingGame label="Join Pending Game" id="pendingList" player="{player}" height="100%" width="100%" gameJoined="dispatchEvent(event)"/>
            <component:StartNewGame  label="Start New Game" player="{player}" height="100%" width="100%" registered="dispatchEvent(event)"/>
		</mx:TabNavigator>				
        <mx:Button id="updateBtn" label="Update" click="reload(event)" />
	</mx:Panel>

</mx:Box>
