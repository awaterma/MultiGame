<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" 
	xmlns:pente="mx.ecosur.multigame.pente.*"
	xmlns:component="mx.ecosur.multigame.component.*"
	xmlns:admin="mx.ecosur.multigame.admin.*"
	layout="absolute" 
	backgroundGradientColors="[#222222, #333333]" backgroundColor="#333333">
	
	<mx:Style source="~/style.css"/>
	
	<mx:Script> 
        <![CDATA[
        	private function startGame(event:Event):void {
        		if (registrationWindow.gameType == "PENTE"){
        			penteGameWindow.currentPlayer = registrationWindow.currentPlayer;
        			penteGameWindow.rows = registrationWindow.currentPlayer.game.rows;
        			penteGameWindow.columns = registrationWindow.currentPlayer.game.columns;
        		
        			vstack.selectedChild = penteGameWindow;
        		}
        	}
        	
        	/* Loads the GameLobby Chat screen */
        	private function loadLobby (event:Event):void {
        		
        	}
        	
        	/* Loads the Administration Window */
        	private function loadAdministration(event:Event):void {
        		  /* Currently this simply points to the RobotAdmin page,
        		  as time progresses, this should point to another managed
        		  view stack of Administration pages */
        		vstack.selectedChild = robotAdministration;
        	}
        	
        	/* Resigns all players from the completed game (if not ended), 
        	and directs the user to the lobby */
        	private function gameComplete (event:Event):void {
        		
        		/* redirect to the lobby */ 
        		loadLobby(event);
        	}
        	
        	private function routeUser (event:Event):void {
        		/* Ugly use of ADMIN name to switch window types, used for testing */
        		if (registrationWindow.currentPlayer.player.name=='ADMIN' || 
        		    registrationWindow.currentPlayer.player.type == "ADMINISTRATOR") 
        		{
        	       loadAdministration(event);		
        		} else {
        			startGame(event);
        		}
        	}
        
        ]]>
    </mx:Script>
	
    <mx:ViewStack id="vstack" width="100%" height="100%" verticalCenter="0">
		<component:RegistrationWindow id="registrationWindow" complete="routeUser(event)" />
		<!--checkers:checkersGameWindow id="checkersGameWindow"/-->
		<pente:PenteGameWindow id="penteGameWindow" complete="gameComplete(event)" />
		<admin:RobotAdministration id="robotAdministration"/>
	</mx:ViewStack>
</mx:Application>
