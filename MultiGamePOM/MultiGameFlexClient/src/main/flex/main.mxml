<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" 
	xmlns:pente="mx.ecosur.multigame.pente.*"
	xmlns:component="mx.ecosur.multigame.component.*"
	layout="absolute">
	
	<mx:Style source="~/style.css"/>
	
	<mx:Script> 
        <![CDATA[
        	import mx.ecosur.multigame.entity.GamePlayer;
        	import mx.ecosur.multigame.event.GamePlayerEvent;
        	import mx.ecosur.multigame.event.PlayerEvent;
        	import mx.ecosur.multigame.entity.Player;
        	import mx.controls.Alert;
        	import mx.ecosur.multigame.pente.PenteGameWindow;
        	
        	private var _penteGameWindow:PenteGameWindow;
        	
        	private function gameComplete (event:Event):void {
        		lobby.reload(event);
        		vstack.selectedChild = lobby;
        		vstack.removeChild(_penteGameWindow);
        	}
        	
        	private function loginDone(event:PlayerEvent):void{
        		lobby.player = event.player;
        		vstack.selectedChild = lobby;
        	}
        	
        	private function lobbyDone(event:GamePlayerEvent):void{       		
        		
        		//create new pente game window
        		_penteGameWindow = new PenteGameWindow();
        		_penteGameWindow.currentPlayer = event.gamePlayer;
        		_penteGameWindow.rows = event.gamePlayer.game.rows;
        		_penteGameWindow.columns = event.gamePlayer.game.columns;
        		_penteGameWindow.addEventListener("complete", gameComplete);
        		
        		//select new window
        		vstack.addChild(_penteGameWindow);
        		vstack.selectedChild = _penteGameWindow;
        	}
        
        ]]>
    </mx:Script>
	
    <mx:ViewStack id="vstack" width="100%" height="100%" verticalCenter="0">
    	<component:Login id="login" complete="loginDone(event)" />
    	<component:Lobby id="lobby" registered="lobbyDone(event)" gameChosen="lobbyDone(event)" gameJoined="lobbyDone(event)" />
		<pente:PenteGameWindow id="penteGameWindow" complete="gameComplete(event)" />
	</mx:ViewStack>
</mx:Application>
