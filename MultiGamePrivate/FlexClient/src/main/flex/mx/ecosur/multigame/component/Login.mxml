<?xml version="1.0" encoding="utf-8"?>
<mx:Box xmlns:mx="http://www.adobe.com/2006/mxml" width="100%" height="100%" horizontalAlign="center" verticalAlign="middle" creationComplete="txtName.setFocus()">

	<mx:Metadata>
        [Event(name="complete", type="mx.ecosur.multigame.event.PlayerEvent")]
    </mx:Metadata>

	<mx:Script> 
        <![CDATA[

        	import mx.rpc.events.FaultEvent;
        	import mx.rpc.events.ResultEvent;
            import mx.ecosur.multigame.event.PlayerEvent;
            import mx.controls.Alert;
            import mx.utils.StringUtil;
            import mx.ecosur.multigame.entity.Registrant;
            
            public var player:Registrant;
    
            private function doLogin(eventObj:MouseEvent):void {

                if (StringUtil.trim(txtName.text).length == 0){
                    Alert.show("Please insert your player name", "Data incomplete");
                    txtName.setFocus();
                }

                gameService.login(txtName.text);
            }
            
            private function resultHandler(event:ResultEvent):void{
                player = Registrant(event.result);
                dispatchEvent(new PlayerEvent("complete", player));
            }
                        
            private function faultHandler(event:FaultEvent):void{
            	Alert.show(event.fault.faultString, "Error!");
            }
        ]]>
    </mx:Script>
    <mx:RemoteObject id="gameService" destination="gameService" result="resultHandler(event)" fault="faultHandler(event)"/>
    <mx:Panel title="Multigame Platform">
        <mx:Text paddingLeft="10" paddingRight="10" paddingTop="10"><mx:text>Please enter your name to begin.</mx:text></mx:Text>
        <mx:Form x="0" y="0" defaultButton="{loginBtn}" id="form">
            <mx:FormItem label="Player" required="true">
                <mx:TextInput id="txtName" />
            </mx:FormItem>
            <mx:FormItem>
                    <mx:Button id="loginBtn" label="Play" click="doLogin(event)" />
            </mx:FormItem>
        </mx:Form>
    </mx:Panel>

</mx:Box>
